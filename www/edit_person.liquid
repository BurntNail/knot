{% include "partials/header.liquid" %}

<h2>Edit Person</h2>
{% assign can_edit = auth.permissions["edit_people"] %}

<div class="card">
  <div class="card-body">
    <form method="POST">

      <div class="input-group mb-3">
        <span class="input-group-text" id="first_name">First Name:
        </span>
        <input
          type="text"
          class="form-control"
          name="first_name"
          id="first_name"
          value="{{person.first_name}}"
          required {% unless can_edit %}
          disabled
          {% endunless %}>
      </div>
      <div class="input-group mb-3">
        <span class="input-group-text" id="surname">Surname:
        </span>
        <input
          type="text"
          class="form-control"
          name="surname"
          id="surname"
          value="{{person.surname}}"
          required {% unless can_edit %}
          disabled
          {% endunless %}>
      </div>
      <div class="input-group mb-3">
        <span class="input-group-text" id="form">Form:
        </span>
        <input
          type="text"
          class="form-control"
          name="form"
          id="form"
          value="{{person.form}}" {% unless can_edit %}
          disabled
          {% endunless %}>
      </div>

      <div class="input-group mb-3">
        <div class="form-check">
          <input
            class="form-check-input"
            type="radio"
            name="is_prefect"
            id="is_not"
            value="false"
            {% unless person.is_prefect %}
            checked
            {% endunless %} {% unless can_edit %}
            disabled
            {% endunless %}>
          <label class="form-check-label" for="is_not">
            Is not a prefect.
          </label>
        </div>
        <br>
        <div class="form-check">
          <input
            class="form-check-input"
            type="radio"
            name="is_prefect"
            id="is"
            value="true"
            {% if person.is_prefect %}
            checked
            {% endif %} {% unless can_edit %}
            disabled
            {% endunless %}>
          <label class="form-check-label" for="is">
            Is a prefect.
          </label>
        </div>
      </div>

      <button type="submit" class="btn btn-primary" {% unless can_edit %}
      disabled
      {% endunless %}>Edit person.</button>
    </form>
  </div>
</div>


{% if can_edit %}
<br>
<form method="POST" action="/reset_password">
<input
  type="hidden"
  name="id"
  value="{{person.id}}">
<button
  type="submit"
  class="btn btn-danger"
  {% unless person.password_is_set %}
  disabled
  {% endunless %}>Reset Password.</button>
</form>
{% endif %}

<br>

<div class="row">
  {% if person.is_prefect %}
    <div class="col">
      <div class="card">
        <div class="card-body">
          <h2 class="card-title">Events Supervised</h2>
          <table class="table">
            <thead>
              <tr>
                <td scope="col">Event</td>
                <td scope="col">Date</td>
              </tr>
            </thead>
            <tbody>
              {% for event in supervised %}
                <tr>
                  <td scope="row"><a href="/update_event/{{event.id}}"></a>{{event.name}}</a></td>
                  <td>{{event.date}}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  {% endif %}
  <div class="col">
    <div class="card">
      <div class="card-body">
        <h2 class="card-title">Events Attended</h2>
        <table class="table">
          <thead>
            <tr>
              <td scope="col">Event</td>
              <td scope="col">Date</td>
            </tr>
          </thead>
          <tbody>
            {% for event in participated %}
              <tr>
                <td scope="row"><a href="/update_event/{{event.id}}"></a>{{event.name}}</a></td>
                <td>{{event.date}}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>


{% include "partials/footer.liquid" %}