<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous">
    <title>Knot</title>
  </head>
  <body>
    <div class="container">
      <h2>Knot - House Events</h2>
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">ICalendar Link:</h5>
          <div class="card">
            <div class="card-body">
              <a href="https://knot.maguire.tech/ical" target="_blank">https://knot.maguire.tech/ical</a>
            </div>
          </div>
          <a href="https://support.google.com/calendar/answer/37100?hl=en" class="card-link">Setup for Google Calendar</a>
          <a href="https://support.apple.com/en-gb/HT202361" class="card-link">Setup for Apple Calendar</a>
        </div>
      </div>


      <br>

<h2>Future Events</h2>

<table class="table">
  <thead>
    <tr>
      <th scope="col">Event Name</th>
      <th scope="col">Date</th>
      <th scope="col">Location</th>
      <th scope="col">Teacher</th>
      <th scope="col">Other Information</th>
      <th scope="col">Modify/Add</th>
      <th scope="col">Participants</th>
      <th scope="col">Prefects</th>
    </tr>
  </thead>
  <tbody>
    {% for row in events_to_happen %}
      {% if row.n_prefects > row.n_participants %}
      {% assign max = row.n_prefects %}
      {% else %}
      {% assign max = row.n_participants %}
      {% endif %}

      {% if max == 0 %}
      {% assign rowspan = 1 %}
      {% else %}
      {% assign rowspan = max %}
      {% endif %}
      <tr>
        <th scope="row" rowspan="{{ rowspan }}">
          {{ row.event.event_name }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.date }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.location }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.teacher }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.other_info }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          <a href="/kingsleyisbest123/update_event/{{row.event.id}}">Modify/Add</a>
        </td>
        {% if max > 0 %}
        {% assign mmo = max | minus: 1 %}
        {% for i in (0..mmo) %}
            {% if i < row.n_participants %}
            <td scope="row">{{ row.participants[i].person_name }}</td>
            {%else%}
            <td></td>
            {%endif%}

            {% if i < row.n_prefects %}
            <td scope="row">{{ row.prefects[i].person_name }}</td>
            {%else%}
            <td></td>
            {%endif%}
          </tr>
          {% unless forloop.last %} <tr> {% endunless %}
        {% endfor %}
        {% else %}
        <td> </td><td> </td>
        </tr>
        {% endif %}
    {% endfor %}
  </tbody>
</table>

<br><br>

<h2>Past Events</h2>

<table class="table">
  <thead>
    <tr>
      <th scope="col">Event Name</th>
      <th scope="col">Date</th>
      <th scope="col">Location</th>
      <th scope="col">Teacher</th>
      <th scope="col">Other Information</th>
      <th scope="col">Participants</th>
      <th scope="col">Prefects</th>
    </tr>
  </thead>
  <tbody>
    {% for row in happened_events %}
      {% if row.n_prefects > row.n_participants %}
      {% assign max = row.n_prefects %}
      {% else %}
      {% assign max = row.n_participants %}
      {% endif %}

      {% if max == 0 %}
      {% assign rowspan = 1 %}
      {% else %}
      {% assign rowspan = max %}
      {% endif %}
      <tr>
        <th scope="row" rowspan="{{ rowspan }}">
          {{ row.event.event_name }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.date }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.location }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.teacher }}
        </td>
        <td scope="row" rowspan="{{ rowspan }}">
          {{ row.event.other_info }}
        </td>
        {% if max > 0 %}
        {% assign mmo = max | minus: 1 %}
        {% for i in (0..mmo) %}
            {% if i < row.n_participants %}
            <td scope="row">{{ row.participants[i].person_name }}</td>
            {%else%}
            <td></td>
            {%endif%}

            {% if i < row.n_prefects %}
            <td scope="row">{{ row.prefects[i].person_name }}</td>
            {%else%}
            <td></td>
            {%endif%}
          </tr>
          {% unless forloop.last %} <tr> {% endunless %}
        {% endfor %}
        {% else %}
        <td> </td><td> </td>
        </tr>
        {% endif %}
    {% endfor %}
  </tbody>
</table>



    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
      crossorigin="anonymous"></script>
  </body>
</html>